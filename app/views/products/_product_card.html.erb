<div class="card">
  <div class="card-image">
    <figure class="image is-4by3">
      <% if product.main_image %>
        <%= image_tag product.main_image, alt: product.name %>
      <% else %>
        <div class="has-background-grey-lighter is-flex is-align-items-center is-justify-content-center" style="height: 200px;">
          <span class="has-text-grey">No Image</span>
        </div>
      <% end %>
    </figure>
  </div>
  
  <div class="card-content">
    <div class="media">
      <div class="media-content">
        <p class="title is-5"><%= link_to product.name, product_path(product) %></p>
        <p class="subtitle is-6 has-text-primary has-text-weight-bold"><%= product.formatted_price %></p>
      </div>
    </div>

    <div class="content">
      <%= truncate(product.description, length: 100) %>
      
      <% if product.categories.any? %>
        <div class="tags mt-2">
          <% product.categories.each do |category| %>
            <span class="tag is-light"><%= category.name %></span>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
  
  <footer class="card-footer">
    <%= link_to "View Details", product_path(product), class: "card-footer-item" %>
    
    <% if product.in_stock? %>
      <%= form_with url: cart_items_path, local: true, class: "card-footer-item" do |f| %>
        <%= f.hidden_field :product_id, value: product.id %>
        <%= f.hidden_field :quantity, value: 1 %>
        <%= f.submit "Add to Cart", class: "button is-primary is-fullwidth" %>
      <% end %>
    <% else %>
      <span class="card-footer-item has-text-grey">Out of Stock</span>
    <% end %>
  </footer>
</div>